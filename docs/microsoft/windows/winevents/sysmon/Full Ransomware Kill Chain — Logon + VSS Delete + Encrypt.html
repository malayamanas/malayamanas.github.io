<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Full Ransomware Kill Chain — Logon + VSS Delete + Encrypt</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Sysmon Detection SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Full Ransomware Kill Chain — Logon + VSS Delete + Encrypt</h1>
  <div class="page-meta">
    <span class="badge badge-critical">Critical</span>
    <span class="meta-item"><strong>Sysmon Event IDs:</strong> 1,3,11,23</span>
    <span class="meta-item"><strong>Tactics:</strong> Defense Evasion | Impact</span>
  </div>
  <div class="page-tags"><span class="tag-pill">impact</span> <span class="tag-pill">defense_evasion</span> <span class="tag-pill">t1486</span> <span class="tag-pill">t1490</span> <span class="tag-pill">t1070</span> <span class="tag-pill">t1531</span></div>
</div>
<main class="content">
<hr>

<strong>Sysmon Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> Full Ransomware Kill Chain — Logon + VSS Delete + Encrypt

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Full Ransomware Kill Chain — Logon + VSS Delete + Encrypt</td></tr>
<tr><td><strong>Primary Sysmon Event ID(s)</strong></td><td>1 (Process Creation), 3 (Network Connection), 11 (FileCreate), 23 (FileDelete (Archived))</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1486</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Defense Evasion, Impact</td></tr>
<tr><td><strong>Detection Level</strong></td><td>Critical</td></tr>
<tr><td><strong>Log Source</strong></td><td>Sysmon (System Monitor) Event Log</td></tr>
<tr><td><strong>Logsource Category</strong></td><td>sysmon</td></tr>
<tr><td><strong>Tags</strong></td><td>impact, defense_evasion, t1486, t1490, t1070, t1531</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary bypasses, disables, or subverts security monitoring and controls through Full Ransomware Kill Chain — Logon + VSS Delete + Encrypt. Sysmon Event(s) 1, 3, 11, 23 (Process Creation, Network Connection, FileCreate, FileDelete (Archived)) provide the primary Sysmon-layer detection signal for this technique.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>     : Defense Evasion  </li>
</ul><br>
  <strong>Technique</strong> : Data Encrypted for Impact (T1486)<br>
<ul>
  <li><strong>Tactic</strong>     : Impact  </li>
</ul><br>
  <strong>Technique</strong> : Inhibit System Recovery (T1490)<br>
<ul>
  <li><strong>Tactic</strong>     : Impact  </li>
</ul><br>
  <strong>Technique</strong> : T1070 (T1070)<br>
<ul>
  <li><strong>Tactic</strong>     : Impact  </li>
</ul><br>
  <strong>Technique</strong> : Account Access Removal (T1531)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker achieves broad network access through lateral movement, often using compromised domain admin credentials.</li>
  <li>Ransomware binary is distributed via GPO, scheduled task, or PsExec — Sysmon Event 1 captures the initial execution; Event 3 captures the distribution SMB connections.</li>
  <li>Pre-encryption: vssadmin.exe / wmic.exe delete shadow copies (Sysmon Event 1), backup/AV services are stopped.</li>
  <li>Ransomware encrypts files in-place: Sysmon Event 11 (FileCreate) fires for each encrypted file; Event 23 (FileDelete) fires as originals are deleted — bulk patterns across thousands of files are the key indicator.</li>
  <li>Ransom notes are dropped: additional Sysmon Event 11 events for README.txt or similar files in every directory.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>LockBit, BlackCat/ALPHV, Cl0p, Royal, Akira ransomware families</li>
  <li>Conti / BlackBasta (affiliate-deployed)</li>
  <li>Ryuk (TrickBot → Ryuk chain)</li>
</ul>

<h3 id="4-key-sysmon-event-indicators">4. Key Sysmon Event Indicators</h3>

<h4 id="sysmon-event-1-process-creation">Sysmon Event 1 — Process Creation</h4>

<p>A new process was created. Captures image path, command line, parent, hashes, user, and integrity level.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>Image</strong></td><td>Unknown executables in %TEMP%, %AppData%, %ProgramData%; executables with random or GUID-like names; vssadmin.exe, wmic.exe (pre-encryption cleanup)</td><td>Ransomware binary location; staging directories and random names are consistent with ransomware deployment patterns</td></tr>
<tr><td><strong>CommandLine</strong></td><td>vssadmin.exe delete shadows /all /quiet; bcdedit /set {default} recoveryenabled No; net stop *backup*; encrypted file extension patterns</td><td>Pre-encryption commands targeting VSS and backup services; these commands consistently precede ransomware encryption</td></tr>
<tr><td><strong>ParentImage</strong></td><td>Office apps (winword.exe, excel.exe) spawning PowerShell/cmd; browsers spawning cmd; svchost.exe spawning unexpected children; w3wp.exe (IIS) spawning shells</td><td>Abnormal parent-child relationships reveal the initial execution vector (macro, exploit, injection)</td></tr>
<tr><td><strong>ParentCommandLine</strong></td><td>Encoded PowerShell from Office; mshta.exe launching script; wscript.exe executing remote content</td><td>Parent&#x27;s full command clarifies the delivery mechanism and payload stage</td></tr>
<tr><td><strong>OriginalFileName</strong></td><td>Mismatch between Image filename and OriginalFileName field (e.g., Image=svchost.exe but OriginalFileName=mimikatz.exe)</td><td>Catches renamed attacker tools that attempt to masquerade as legitimate Windows binaries</td></tr>
<tr><td><strong>Hashes</strong></td><td>Known malware hashes (cross-reference threat intelligence feeds); unsigned binaries with high-entropy names</td><td>Hash-based detection is immune to filename changes; enables instant enrichment with threat intelligence</td></tr>
<tr><td><strong>IntegrityLevel</strong></td><td>High or System from a process spawned by a low-privilege parent; elevation without UAC prompt context</td><td>Indicates whether the process ran with elevated privileges; unexpected elevation reveals bypass techniques</td></tr>
<tr><td><strong>User</strong></td><td>SYSTEM-context processes from interactive user sessions; service accounts launching interactive processes</td><td>Process owner; unexpected user context for a given image path indicates impersonation or privilege escalation</td></tr>
</tbody></table>

<h4 id="sysmon-event-3-network-connection">Sysmon Event 3 — Network Connection</h4>

<p>An outbound or inbound TCP/UDP connection was established. Captures source/destination IP, port, and process.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>DestinationIp</strong></td><td>Non-RFC1918 addresses from internal processes; Tor exit nodes; cloud infrastructure IPs (AWS/Azure ranges not matching enterprise use); C2 IP ranges from threat intel</td><td>Destination of the connection; external IPs from unexpected processes indicate C2, exfiltration, or lateral movement staging</td></tr>
<tr><td><strong>DestinationPort</strong></td><td>445 (SMB lateral), 135/4444 (RPC/Meterpreter), 88 (Kerberos), 389/636 (LDAP), 3389 (RDP), 5985/5986 (WinRM), 53 (DNS C2), 443 from non-browser processes</td><td>Destination port reveals the intended protocol; port anomalies identify attacker tools abusing expected channels</td></tr>
<tr><td><strong>DestinationHostname</strong></td><td>Random-character domains (DGA), newly registered domains, domains not in corporate allow-list, C2 domains from threat intel feeds</td><td>Destination hostname for C2 detection; DGA domains and suspicious TLDs are high-confidence indicators</td></tr>
<tr><td><strong>Image</strong></td><td>LSASS.exe making outbound connections, svchost.exe connecting to non-Microsoft IPs, powershell.exe/cmd.exe making direct outbound connections</td><td>Process initiating the network connection; system processes making unexpected external connections indicate compromise</td></tr>
<tr><td><strong>Initiated</strong></td><td>True (outbound) from LSASS, winlogon, or svchost to external addresses; False (inbound) on non-standard ports from Internet</td><td>Connection direction; outbound from credential processes to external hosts indicates exfiltration</td></tr>
<tr><td><strong>SourcePort</strong></td><td>High-numbered ephemeral ports from persistent long-running processes; same source port across multiple connections (keepalive)</td><td>Source port; persistent connections from the same source port indicate sustained C2 sessions</td></tr>
<tr><td><strong>Protocol</strong></td><td>UDP from processes that normally use TCP; ICMP from any process (tunnelling); non-standard protocol numbers from system processes</td><td>Transport protocol; tunnelling attacks over DNS/ICMP use protocol anomalies as a covert channel</td></tr>
</tbody></table>

<h4 id="sysmon-event-11-filecreate">Sysmon Event 11 — FileCreate</h4>

<p>A file was created or overwritten. Captures filename, creating process, and creation timestamp.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetFilename</strong></td><td>Executables in %TEMP%, %AppData%, %ProgramData% or user-writable paths; files with double extensions (.pdf.exe); web shell paths (C:\inetpub\wwwroot\*.aspx, *.php); files in SYSVOL or NETLOGON; DMP files (lsass.dmp, memory.dmp)</td><td>Path of the created file; staging directories, web roots, and dump files are high-priority exfiltration and persistence indicators</td></tr>
<tr><td><strong>Image</strong></td><td>powershell.exe, cmd.exe, wscript.exe, certutil.exe, bitsadmin.exe, mshta.exe creating files — LOLBin-based file delivery; w3wp.exe creating files outside its webroot</td><td>Process creating the file; LOLBins and IIS worker processes creating unexpected files reveal attacker file delivery and web shell implantation</td></tr>
<tr><td><strong>CreationUtcTime</strong></td><td>Files created at unusual hours; rapid succession of file creation (ransomware encryption loop); creation timestamp predating system installation (anti-forensic)</td><td>When the file was created; burst file creation patterns indicate ransomware encryption; off-hours creation correlates with attacker activity windows</td></tr>
</tbody></table>

<h4 id="sysmon-event-23-filedelete-archived">Sysmon Event 23 — FileDelete (Archived)</h4>

<p>A file was deleted (and archived by Sysmon). Captures evidence destruction and ransomware encryption-and-delete patterns.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetFilename</strong></td><td>Log files, forensic artefacts, evidence directories (.evtx, .etl, prefetch .pf files); encrypted original files being deleted after ransomware encryption (bulk pattern); credential dump files (lsass.dmp, ntds.dit copies)</td><td>File being deleted; bulk deletion of user files indicates ransomware; deletion of log/forensic files indicates evidence destruction</td></tr>
<tr><td><strong>Image</strong></td><td>vssadmin.exe, wmic.exe, powershell.exe deleting shadow copies or logs; ransomware binary deleting originals after encryption; sdelete.exe performing secure deletion</td><td>Process deleting the file; known evidence-destruction tools, ransomware binaries, and secure-deletion utilities performing file deletions are high-priority IOCs</td></tr>
<tr><td><strong>IsExecutable</strong></td><td>True — executable files being deleted after execution (fileless malware cleanup) or before encryption (ransomware targeting executables)</td><td>Whether the deleted file is an executable; executable deletion by ransomware or malware indicates post-execution cleanup or targeted destruction</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (Critical Confidence)</strong>
<ul>
  <li>Alert on Sysmon event(s) 1, 3, 11, 23 matching the field combinations shown in Section 4</li>
  <li>Apply environment-specific thresholds: a single matching event may be sufficient for critical-level detections</li>
</ul>

<strong>Sigma Detection Rule (YAML skeleton):</strong>
<pre><code class="language-yaml">title: Full Ransomware Kill Chain — Logon + VSS Delete + Encrypt
status: experimental
logsource:
    category: process_creation  # adjust per primary Sysmon event type
    product: windows
detection:
    selection:
    EventID: 1  # Sysmon Process Creation
    Image|endswith|any:
      - &#x27;\\vssadmin.exe&#x27;
      - &#x27;\\wmic.exe&#x27;
      - &#x27;\\bcdedit.exe&#x27;
    CommandLine|contains|any:
      - &#x27;delete shadows&#x27;
      - &#x27;shadowcopy delete&#x27;
      - &#x27;recoveryenabled No&#x27;
    condition: selection
level: critical
tags:
    - impact
    - defense_evasion
    - t1486
    - t1490
    - t1070
    - t1531
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Hunt for <code>Sysmon 1 / Sysmon 3 / Sysmon 11 / Sysmon 23</code> events where Image is NOT in the approved software baseline</li>
  <li>Alert on Sysmon 1 / Sysmon 3 / Sysmon 11 / Sysmon 23 from accounts in privileged groups outside approved maintenance windows</li>
  <li>Correlate Sysmon 1 events with subsequent Windows Security 4624/4625 events to link process activity to authentication events</li>
  <li>Stack-rank <code>Sysmon 1 / Sysmon 3 / Sysmon 11 / Sysmon 23</code> events by Image path to identify rare/novel executables across the fleet</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate administrative operations by IT staff may generate similar Sysmon events</li>
  <li>Authorized enterprise management platforms performing identical operations</li>
  <li>Security scanning and vulnerability assessment tools in approved assessment windows</li>
  <li>Development and testing environments running attack simulation frameworks</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enable Controlled Folder Access (Windows Defender) to block unauthorized file modification</li>
  <li>Implement immutable offline backups following the 3-2-1-1-0 rule</li>
  <li>Restrict vssadmin.exe and wmic.exe execution using AppLocker/WDAC policies</li>
  <li>Enable file screening on file servers to detect bulk file extension changes</li>
  <li>Deploy application allowlisting to prevent unknown executables from running</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (from Sysmon Event 1 User field or Windows Security 4624 correlation) and disable it pending investigation.</li>
  <li>Preserve Sysmon event logs from the affected host(s) before any remediation — export the Microsoft-Windows-Sysmon/Operational channel.</li>
  <li>Correlate the Sysmon events with Windows Security logs using the LogonId field to link process activity to authenticated sessions.</li>
  <li>Immediately disconnect all affected hosts from network shares and backup infrastructure to prevent ransomware spread.</li>
  <li>Identify the ransomware strain via Sysmon Event 1 Image hash and check for available decryptors (nomoreransom.org).</li>
  <li>Restore from the most recent clean backup after confirming the restore environment is fully isolated and clean.</li>
  <li>Engage legal, compliance, and communications teams — ransomware incidents typically trigger regulatory notification requirements.</li>
  <li>Conduct root cause analysis to identify and close the initial access vector before any restoration to production.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>