<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Camera or Microphone Device Access</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Sysmon Detection SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Camera or Microphone Device Access</h1>
  <div class="page-meta">
    <span class="badge badge-medium">Medium</span>
    <span class="meta-item"><strong>Sysmon Event IDs:</strong> 12,13</span>
    <span class="meta-item"><strong>Tactics:</strong> Discovery | Collection</span>
  </div>
  <div class="page-tags"><span class="tag-pill">discovery</span> <span class="tag-pill">collection</span> <span class="tag-pill">t1125</span> <span class="tag-pill">t1123</span></div>
</div>
<main class="content">
<hr>

<strong>Sysmon Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> Camera or Microphone Device Access

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Camera or Microphone Device Access</td></tr>
<tr><td><strong>Primary Sysmon Event ID(s)</strong></td><td>12 (RegistryEvent (Object Created/Deleted)), 13 (RegistryEvent (Value Set))</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1125</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Discovery, Collection</td></tr>
<tr><td><strong>Detection Level</strong></td><td>Medium</td></tr>
<tr><td><strong>Log Source</strong></td><td>Sysmon (System Monitor) Event Log</td></tr>
<tr><td><strong>Logsource Category</strong></td><td>sysmon</td></tr>
<tr><td><strong>Tags</strong></td><td>discovery, collection, t1125, t1123</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary enumerates the target environment to identify assets and attack paths through Camera or Microphone Device Access. Sysmon Event(s) 12, 13 (RegistryEvent (Object Created/Deleted), RegistryEvent (Value Set)) provide the primary Sysmon-layer detection signal for this technique.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>     : Discovery  </li>
</ul><br>
  <strong>Technique</strong> : T1125 (T1125)<br>
<ul>
  <li><strong>Tactic</strong>     : Collection  </li>
</ul><br>
  <strong>Technique</strong> : T1123 (T1123)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker achieves initial access to the target environment through social engineering, exploitation, or stolen credentials.</li>
  <li>Using the established foothold, the attacker performs enumerates the target environment to identify assets related to Camera or Microphone Device Access.</li>
  <li>MITRE ATT&amp;CK technique T1125 is leveraged using tools and techniques observed consistently in 2024–2026 campaigns.</li>
  <li>Sysmon Event(s) 12, 13 are generated, capturing critical process, network, file, or registry activity depending on the specific technique.</li>
  <li>Post-attack, the attacker may perform additional lateral movement, persistence, or data collection based on the access and capabilities gained.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>CobaltStrike (commercial C2 framework)</li>
  <li>Metasploit Framework (open-source exploitation)</li>
  <li>Impacket (Python network protocol library)</li>
  <li>CrackMapExec (post-exploitation framework)</li>
  <li>PowerSploit / PowerView (PowerShell attack modules)</li>
</ul>

<h3 id="4-key-sysmon-event-indicators">4. Key Sysmon Event Indicators</h3>

<h4 id="sysmon-event-12-registryevent-object-createddeleted">Sysmon Event 12 — RegistryEvent (Object Created/Deleted)</h4>

<p>A registry key or value was created or deleted. Captures the key path and the responsible process.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetObject</strong></td><td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run*; HKCU\...\Run*; HKLM\SYSTEM\CurrentControlSet\Services\*; HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders; HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</td><td>Registry key being created or deleted; persistence-relevant key paths are primary targets; deletion of security key paths indicates defense evasion</td></tr>
<tr><td><strong>EventType</strong></td><td>CreateKey (new persistence entry) or DeleteKey (removing evidence or security key)</td><td>Type of registry operation; CreateKey in persistence paths establishes foothold; DeleteKey in security paths indicates audit evasion</td></tr>
<tr><td><strong>Image</strong></td><td>powershell.exe, reg.exe, regedit.exe, wscript.exe, mshta.exe creating/deleting persistence-related keys; unusual processes modifying security-relevant registry paths</td><td>Process performing the registry modification; scripting engines and shells modifying persistence paths are primary persistence indicators</td></tr>
</tbody></table>

<h4 id="sysmon-event-13-registryevent-value-set">Sysmon Event 13 — RegistryEvent (Value Set)</h4>

<p>A registry value was set. Captures the key path, value name, and new data written.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetObject</strong></td><td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\* (startup persistence); HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\*\Debugger (IFEO hijack); HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages (LSA DLL); HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA (UAC disable); HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential (WDigest enable)</td><td>Exact registry path being written; specific paths identify the persistence mechanism, credential exposure technique, or defense evasion method</td></tr>
<tr><td><strong>Details</strong></td><td>Paths in %TEMP%, %AppData%, or UNC paths (\\server\share\payload.exe); PowerShell -EncodedCommand values; base64-encoded strings; 1 (enabling WDigest/features that weaken security)</td><td>The actual value written; payload paths, encoded commands, and security-weakening flags in the data field are direct IOCs</td></tr>
<tr><td><strong>Image</strong></td><td>powershell.exe, reg.exe, regedit.exe, mshta.exe, wscript.exe setting registry values; non-standard processes modifying LSA or Winlogon keys</td><td>Process writing the registry value; unexpected processes modifying sensitive registry paths reveal the persistence or defense evasion tool</td></tr>
<tr><td><strong>EventType</strong></td><td>SetValue (value data being written)</td><td>Always SetValue for this event; the field confirms this is a write operation rather than a key creation</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (Medium Confidence)</strong>
<ul>
  <li>Alert on Sysmon event(s) 12, 13 matching the field combinations shown in Section 4</li>
  <li>Apply environment-specific thresholds: a single matching event may be sufficient for critical-level detections</li>
</ul>

<strong>Sigma Detection Rule (YAML skeleton):</strong>
<pre><code class="language-yaml">title: Camera or Microphone Device Access
status: experimental
logsource:
    category: process_creation  # adjust per primary Sysmon event type
    product: windows
detection:
    selection:
    EventID: 12  # Sysmon RegistryEvent (Object Created/Deleted)
    condition: selection
level: medium
tags:
    - discovery
    - collection
    - t1125
    - t1123
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Hunt for <code>Sysmon 12 / Sysmon 13</code> events where Image is NOT in the approved software baseline</li>
  <li>Alert on Sysmon 12 / Sysmon 13 from accounts in privileged groups outside approved maintenance windows</li>
  <li>Correlate Sysmon 12 events with subsequent Windows Security 4624/4625 events to link process activity to authentication events</li>
  <li>Stack-rank <code>Sysmon 12 / Sysmon 13</code> events by Image path to identify rare/novel executables across the fleet</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate administrative operations by IT staff may generate similar Sysmon events</li>
  <li>Authorized enterprise management platforms performing identical operations</li>
  <li>Security scanning and vulnerability assessment tools in approved assessment windows</li>
  <li>Development and testing environments running attack simulation frameworks</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Apply Principle of Least Privilege: restrict the ability to perform this attack to the minimum required accounts</li>
  <li>Deploy comprehensive Sysmon configuration (SwiftOnSecurity or Florian Roth config) to capture all relevant events</li>
  <li>Configure SIEM correlation rules to baseline normal Sysmon patterns and alert on deviations</li>
  <li>Enable Microsoft Defender for Endpoint or equivalent EDR for behavioral detection in addition to Sysmon event-based detection</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (from Sysmon Event 1 User field or Windows Security 4624 correlation) and disable it pending investigation.</li>
  <li>Preserve Sysmon event logs from the affected host(s) before any remediation — export the Microsoft-Windows-Sysmon/Operational channel.</li>
  <li>Correlate the Sysmon events with Windows Security logs using the LogonId field to link process activity to authenticated sessions.</li>
  <li>Review all Sysmon events (1, 3, 11, 13) from the same LogonId session to identify the full scope of attacker actions.</li>
  <li>Check for additional persistence mechanisms in the same time window using Sysmon Event 12/13/17/18 correlation.</li>
  <li>Conduct a targeted threat hunt across similar hosts in the same network segment for matching Sysmon event patterns.</li>
  <li>Engage the incident response team to scope the full extent of the compromise before returning any affected systems to production.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>