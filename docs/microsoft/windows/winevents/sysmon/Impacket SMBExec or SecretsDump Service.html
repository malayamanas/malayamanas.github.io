<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Impacket SMBExec or SecretsDump Service</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Sysmon Detection SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Impacket SMBExec or SecretsDump Service</h1>
  <div class="page-meta">
    <span class="badge badge-high">High</span>
    <span class="meta-item"><strong>Sysmon Event IDs:</strong> 1,3,17</span>
    <span class="meta-item"><strong>Tactics:</strong> Credential Access | Lateral Movement</span>
  </div>
  <div class="page-tags"><span class="tag-pill">lateral_movement</span> <span class="tag-pill">credential_access</span> <span class="tag-pill">t1569.002</span> <span class="tag-pill">t1003</span></div>
</div>
<main class="content">
<hr>

<strong>Sysmon Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> Impacket SMBExec or SecretsDump Service

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Impacket SMBExec or SecretsDump Service</td></tr>
<tr><td><strong>Primary Sysmon Event ID(s)</strong></td><td>1 (Process Creation), 3 (Network Connection), 17 (PipeEvent (Pipe Created))</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1569.002</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Credential Access, Lateral Movement</td></tr>
<tr><td><strong>Detection Level</strong></td><td>High</td></tr>
<tr><td><strong>Log Source</strong></td><td>Sysmon (System Monitor) Event Log</td></tr>
<tr><td><strong>Logsource Category</strong></td><td>sysmon</td></tr>
<tr><td><strong>Tags</strong></td><td>lateral_movement, credential_access, t1569.002, t1003</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary targets credentials or authentication material to enable further compromise through Impacket SMBExec or SecretsDump Service. Sysmon Event(s) 1, 3, 17 (Process Creation, Network Connection, PipeEvent (Pipe Created)) provide the primary Sysmon-layer detection signal for this technique.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>     : Credential Access  </li>
</ul><br>
  <strong>Technique</strong> : System Services: Service Execution (T1569.002)<br>
<ul>
  <li><strong>Tactic</strong>     : Lateral Movement  </li>
</ul><br>
  <strong>Technique</strong> : OS Credential Dumping (T1003)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker achieves initial access to the target environment through social engineering, exploitation, or stolen credentials.</li>
  <li>Using the established foothold, the attacker performs targets credentials or authentication material related to Impacket SMBExec or SecretsDump Service.</li>
  <li>MITRE ATT&amp;CK technique T1569.002 is leveraged using tools and techniques observed consistently in 2024–2026 campaigns.</li>
  <li>Sysmon Event(s) 1, 3, 17 are generated, capturing critical process, network, file, or registry activity depending on the specific technique.</li>
  <li>Post-attack, the attacker may perform additional lateral movement, persistence, or data collection based on the access and capabilities gained.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>CobaltStrike (commercial C2 framework)</li>
  <li>Metasploit Framework (open-source exploitation)</li>
  <li>Impacket (Python network protocol library)</li>
  <li>CrackMapExec (post-exploitation framework)</li>
  <li>PowerSploit / PowerView (PowerShell attack modules)</li>
</ul>

<h3 id="4-key-sysmon-event-indicators">4. Key Sysmon Event Indicators</h3>

<h4 id="sysmon-event-1-process-creation">Sysmon Event 1 — Process Creation</h4>

<p>A new process was created. Captures image path, command line, parent, hashes, user, and integrity level.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>Image</strong></td><td>PsExec.exe, PSEXESVC.exe (remote service binary), cmd.exe or payload spawned by PSEXESVC</td><td>PsExec service binary and spawned command process; PSEXESVC.exe in System32 is the remote execution service</td></tr>
<tr><td><strong>CommandLine</strong></td><td>\\\\target\ADMIN$ /c payload.exe; psexec.py target command; cmd.exe /c via PSEXESVC service</td><td>PsExec command patterns; remote UNC path execution and service-spawned cmd.exe indicate PsExec lateral movement</td></tr>
<tr><td><strong>ParentImage</strong></td><td>Office apps (winword.exe, excel.exe) spawning PowerShell/cmd; browsers spawning cmd; svchost.exe spawning unexpected children; w3wp.exe (IIS) spawning shells</td><td>Abnormal parent-child relationships reveal the initial execution vector (macro, exploit, injection)</td></tr>
<tr><td><strong>ParentCommandLine</strong></td><td>Encoded PowerShell from Office; mshta.exe launching script; wscript.exe executing remote content</td><td>Parent&#x27;s full command clarifies the delivery mechanism and payload stage</td></tr>
<tr><td><strong>OriginalFileName</strong></td><td>Mismatch between Image filename and OriginalFileName field (e.g., Image=svchost.exe but OriginalFileName=mimikatz.exe)</td><td>Catches renamed attacker tools that attempt to masquerade as legitimate Windows binaries</td></tr>
<tr><td><strong>Hashes</strong></td><td>Known malware hashes (cross-reference threat intelligence feeds); unsigned binaries with high-entropy names</td><td>Hash-based detection is immune to filename changes; enables instant enrichment with threat intelligence</td></tr>
<tr><td><strong>IntegrityLevel</strong></td><td>High or System from a process spawned by a low-privilege parent; elevation without UAC prompt context</td><td>Indicates whether the process ran with elevated privileges; unexpected elevation reveals bypass techniques</td></tr>
<tr><td><strong>User</strong></td><td>SYSTEM-context processes from interactive user sessions; service accounts launching interactive processes</td><td>Process owner; unexpected user context for a given image path indicates impersonation or privilege escalation</td></tr>
</tbody></table>

<h4 id="sysmon-event-3-network-connection">Sysmon Event 3 — Network Connection</h4>

<p>An outbound or inbound TCP/UDP connection was established. Captures source/destination IP, port, and process.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>DestinationIp</strong></td><td>Non-RFC1918 addresses from internal processes; Tor exit nodes; cloud infrastructure IPs (AWS/Azure ranges not matching enterprise use); C2 IP ranges from threat intel</td><td>Destination of the connection; external IPs from unexpected processes indicate C2, exfiltration, or lateral movement staging</td></tr>
<tr><td><strong>DestinationPort</strong></td><td>445 (SMB — primary lateral movement port); 139 (NetBIOS/SMB legacy); 135 (RPC endpoint — WMI/DCOM lateral)</td><td>SMB port 445 is the primary lateral movement vector; connections from non-IT workstations to multiple endpoints indicate lateral movement</td></tr>
<tr><td><strong>DestinationHostname</strong></td><td>Random-character domains (DGA), newly registered domains, domains not in corporate allow-list, C2 domains from threat intel feeds</td><td>Destination hostname for C2 detection; DGA domains and suspicious TLDs are high-confidence indicators</td></tr>
<tr><td><strong>Image</strong></td><td>LSASS.exe making outbound connections, svchost.exe connecting to non-Microsoft IPs, powershell.exe/cmd.exe making direct outbound connections</td><td>Process initiating the network connection; system processes making unexpected external connections indicate compromise</td></tr>
<tr><td><strong>Initiated</strong></td><td>True (outbound) from LSASS, winlogon, or svchost to external addresses; False (inbound) on non-standard ports from Internet</td><td>Connection direction; outbound from credential processes to external hosts indicates exfiltration</td></tr>
<tr><td><strong>SourcePort</strong></td><td>High-numbered ephemeral ports from persistent long-running processes; same source port across multiple connections (keepalive)</td><td>Source port; persistent connections from the same source port indicate sustained C2 sessions</td></tr>
<tr><td><strong>Protocol</strong></td><td>UDP from processes that normally use TCP; ICMP from any process (tunnelling); non-standard protocol numbers from system processes</td><td>Transport protocol; tunnelling attacks over DNS/ICMP use protocol anomalies as a covert channel</td></tr>
</tbody></table>

<h4 id="sysmon-event-17-pipeevent-pipe-created">Sysmon Event 17 — PipeEvent (Pipe Created)</h4>

<p>A named pipe server was created. Used by malware for inter-process C2, lateral movement (PsExec, Cobalt Strike).</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>PipeName</strong></td><td>\\PSEXESVC (PsExec), \\RemCom (Impacket PSExec), \\mojo.* (Chrome, legitimate but check context), \\msagent_* (Cobalt Strike default), \\postex_* (Cobalt Strike), \\status_* (Cobalt Strike), \\MSSE-* (Metasploit)</td><td>Named pipe identifier; tool-specific pipe names are definitive IOCs for PsExec, Impacket, Cobalt Strike, and Metasploit lateral movement</td></tr>
<tr><td><strong>Image</strong></td><td>services.exe (legitimate service pipes), svchost.exe — but also: powershell.exe, cmd.exe, custom beacon processes creating pipes for C2 or tool communication</td><td>Process creating the pipe server; non-service processes creating pipes with known attacker tool names reveal C2 channels and lateral movement staging</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (High Confidence)</strong>
<ul>
  <li>Alert on Sysmon event(s) 1, 3, 17 matching the field combinations shown in Section 4</li>
  <li>Apply environment-specific thresholds: a single matching event may be sufficient for critical-level detections</li>
</ul>

<strong>Sigma Detection Rule (YAML skeleton):</strong>
<pre><code class="language-yaml">title: Impacket SMBExec or SecretsDump Service
status: experimental
logsource:
    category: process_creation  # adjust per primary Sysmon event type
    product: windows
detection:
    selection:
    EventID: 1  # Sysmon Process Creation
    Image|endswith: &#x27;\\mimikatz.exe&#x27;
    CommandLine|contains|any:
      - &#x27;sekurlsa&#x27;
      - &#x27;lsadump&#x27;
      - &#x27;MiniDump&#x27;
      - &#x27;-ma lsass&#x27;
    condition: selection
level: high
tags:
    - lateral_movement
    - credential_access
    - t1569.002
    - t1003
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Hunt for <code>Sysmon 1 / Sysmon 3 / Sysmon 17</code> events where Image is NOT in the approved software baseline</li>
  <li>Alert on Sysmon 1 / Sysmon 3 / Sysmon 17 from accounts in privileged groups outside approved maintenance windows</li>
  <li>Correlate Sysmon 1 events with subsequent Windows Security 4624/4625 events to link process activity to authentication events</li>
  <li>Stack-rank <code>Sysmon 1 / Sysmon 3 / Sysmon 17</code> events by Image path to identify rare/novel executables across the fleet</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate remote administration tools (SCCM, Ansible, PDQ Deploy, SolarWinds) perform identical operations</li>
  <li>IT operations and patch management workflows generate similar Sysmon events</li>
  <li>Authorized penetration testing and red team exercises</li>
  <li>Helpdesk remote assistance sessions</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enable LSASS Protection (PPL) via registry: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL = 1</code></li>
  <li>Disable WDigest to prevent plaintext credential caching: <code>UseLogonCredential = 0</code></li>
  <li>Enable Credential Guard on Windows 10/11 and Windows Server 2016+ to isolate LSASS</li>
  <li>Add lsass.exe as a protected process in Sysmon config to alert on any access event</li>
  <li>Block ProcessAccess to lsass.exe from non-system processes using EDR policy rules</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (from Sysmon Event 1 User field or Windows Security 4624 correlation) and disable it pending investigation.</li>
  <li>Preserve Sysmon event logs from the affected host(s) before any remediation — export the Microsoft-Windows-Sysmon/Operational channel.</li>
  <li>Correlate the Sysmon events with Windows Security logs using the LogonId field to link process activity to authenticated sessions.</li>
  <li>Reset passwords for all accounts confirmed or suspected to be compromised — prioritize privileged accounts.</li>
  <li>If KRBTGT hash was exposed (DCSync), perform two sequential KRBTGT password resets to invalidate existing golden tickets.</li>
  <li>Audit all Kerberos tickets issued since the credential dump — revoke suspicious TGTs by restarting the Kerberos service on DCs.</li>
  <li>Hunt for pass-the-hash or pass-the-ticket usage across the environment using correlated Sysmon Event 3 and Windows Security 4624 NTLM events.</li>
  <li>Review all accounts with DCSync rights (replication permissions) and remove any not belonging to designated sync accounts.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>