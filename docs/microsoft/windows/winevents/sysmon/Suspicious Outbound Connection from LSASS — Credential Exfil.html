<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suspicious Outbound Connection from LSASS — Credential Exfil</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Sysmon Detection SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Suspicious Outbound Connection from LSASS — Credential Exfil</h1>
  <div class="page-meta">
    <span class="badge badge-critical">Critical</span>
    <span class="meta-item"><strong>Sysmon Event IDs:</strong> 3,10</span>
    <span class="meta-item"><strong>Tactics:</strong> Credential Access | Exfiltration</span>
  </div>
  <div class="page-tags"><span class="tag-pill">credential_access</span> <span class="tag-pill">exfiltration</span> <span class="tag-pill">t1003</span> <span class="tag-pill">t1041</span></div>
</div>
<main class="content">
<hr>

<strong>Sysmon Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> Suspicious Outbound Connection from LSASS — Credential Exfil

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Suspicious Outbound Connection from LSASS — Credential Exfil</td></tr>
<tr><td><strong>Primary Sysmon Event ID(s)</strong></td><td>3 (Network Connection), 10 (ProcessAccess)</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1003</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Credential Access, Exfiltration</td></tr>
<tr><td><strong>Detection Level</strong></td><td>Critical</td></tr>
<tr><td><strong>Log Source</strong></td><td>Sysmon (System Monitor) Event Log</td></tr>
<tr><td><strong>Logsource Category</strong></td><td>sysmon</td></tr>
<tr><td><strong>Tags</strong></td><td>credential_access, exfiltration, t1003, t1041</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary targets credentials or authentication material to enable further compromise through Suspicious Outbound Connection from LSASS — Credential Exfil. Sysmon Event(s) 3, 10 (Network Connection, ProcessAccess) provide the primary Sysmon-layer detection signal for this technique.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>     : Credential Access  </li>
</ul><br>
  <strong>Technique</strong> : OS Credential Dumping (T1003)<br>
<ul>
  <li><strong>Tactic</strong>     : Exfiltration  </li>
</ul><br>
  <strong>Technique</strong> : Exfiltration Over C2 Channel (T1041)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker achieves code execution with local administrator or SYSTEM privileges on the target host.</li>
  <li>Sysmon Event 10 (ProcessAccess) fires when the attacker&#x27;s tool opens a handle to lsass.exe with PROCESS_VM_READ rights — this is the primary Sysmon detection signal.</li>
  <li>Sysmon Event 1 captures the dumping tool&#x27;s process creation (Mimikatz, procdump.exe, rundll32.exe comsvcs.dll MiniDump).</li>
  <li>Memory is read from the LSASS process address space, extracting cached Kerberos tickets, NT hashes, and DPAPI keys.</li>
  <li>Sysmon Event 11 may capture the dump file creation (lsass.dmp, memory.dmp) if the attacker writes the dump to disk.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>Mimikatz sekurlsa::logonpasswords</li>
  <li>ProcDump (procdump.exe -ma lsass.exe)</li>
  <li>comsvcs.dll MiniDump method (LOLBin)</li>
  <li>Nanodump / SilentProcessExit</li>
</ul>

<h3 id="4-key-sysmon-event-indicators">4. Key Sysmon Event Indicators</h3>

<h4 id="sysmon-event-3-network-connection">Sysmon Event 3 — Network Connection</h4>

<p>An outbound or inbound TCP/UDP connection was established. Captures source/destination IP, port, and process.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>DestinationIp</strong></td><td>Non-RFC1918 addresses from internal processes; Tor exit nodes; cloud infrastructure IPs (AWS/Azure ranges not matching enterprise use); C2 IP ranges from threat intel</td><td>Destination of the connection; external IPs from unexpected processes indicate C2, exfiltration, or lateral movement staging</td></tr>
<tr><td><strong>DestinationPort</strong></td><td>445 (SMB lateral), 135/4444 (RPC/Meterpreter), 88 (Kerberos), 389/636 (LDAP), 3389 (RDP), 5985/5986 (WinRM), 53 (DNS C2), 443 from non-browser processes</td><td>Destination port reveals the intended protocol; port anomalies identify attacker tools abusing expected channels</td></tr>
<tr><td><strong>DestinationHostname</strong></td><td>Random-character domains (DGA), newly registered domains, domains not in corporate allow-list, C2 domains from threat intel feeds</td><td>Destination hostname for C2 detection; DGA domains and suspicious TLDs are high-confidence indicators</td></tr>
<tr><td><strong>Image</strong></td><td>LSASS.exe making outbound connections, svchost.exe connecting to non-Microsoft IPs, powershell.exe/cmd.exe making direct outbound connections</td><td>Process initiating the network connection; system processes making unexpected external connections indicate compromise</td></tr>
<tr><td><strong>Initiated</strong></td><td>True (outbound) from LSASS, winlogon, or svchost to external addresses; False (inbound) on non-standard ports from Internet</td><td>Connection direction; outbound from credential processes to external hosts indicates exfiltration</td></tr>
<tr><td><strong>SourcePort</strong></td><td>High-numbered ephemeral ports from persistent long-running processes; same source port across multiple connections (keepalive)</td><td>Source port; persistent connections from the same source port indicate sustained C2 sessions</td></tr>
<tr><td><strong>Protocol</strong></td><td>UDP from processes that normally use TCP; ICMP from any process (tunnelling); non-standard protocol numbers from system processes</td><td>Transport protocol; tunnelling attacks over DNS/ICMP use protocol anomalies as a covert channel</td></tr>
</tbody></table>

<h4 id="sysmon-event-10-processaccess">Sysmon Event 10 — ProcessAccess</h4>

<p>A process opened a handle to another process. Captures source/target process and the access rights (GrantedAccess) requested.</p>

<table>
<thead>
<tr><th>Field</th><th>Suspicious Value / Pattern</th><th>Why It Matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetImage</strong></td><td>lsass.exe — the LSASS process holds all cached credentials, Kerberos tickets, and DPAPI keys in its memory space</td><td>LSASS is the exclusive target for memory-based credential dumping; any non-Windows Security tool accessing LSASS with VM_READ rights is a critical indicator</td></tr>
<tr><td><strong>GrantedAccess</strong></td><td>0x1010 (PROCESS_VM_READ</td><td>PROCESS_QUERY_INFORMATION — classic Mimikatz), 0x1410 (adds PROCESS_VM_OPERATION), 0x1F0FFF (full access — procdump style), 0x1FFFFF (maximum access)</td><td>LSASS memory access mask; 0x1010 is the Mimikatz signature access pattern; 0x1F0FFF indicates procdump-style full-process-dump access</td></tr>
<tr><td><strong>SourceImage</strong></td><td>powershell.exe, cmd.exe, procdump.exe, rundll32.exe (comsvcs.dll), werfault.exe (abused), taskhost.exe, non-system processes opening lsass.exe</td><td>Process requesting the handle; any non-security tool opening lsass.exe with memory-read rights is a critical credential dumping indicator</td></tr>
<tr><td><strong>CallTrace</strong></td><td>Calls originating from unbacked memory (shellcode): [heap], [stack]; absence of ntdll.dll/kernelbase.dll; Mimikatz-specific call stack patterns</td><td>Stack trace of the access request; shellcode-based dumpers leave no legitimate module reference — unbacked memory calls are definitive injection indicators</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (Critical Confidence)</strong>
<ul>
  <li>Alert on Sysmon event(s) 3, 10 matching the field combinations shown in Section 4</li>
  <li>Apply environment-specific thresholds: a single matching event may be sufficient for critical-level detections</li>
</ul>

<strong>Sigma Detection Rule (YAML skeleton):</strong>
<pre><code class="language-yaml">title: Suspicious Outbound Connection from LSASS — Credential Exfil
status: experimental
logsource:
    category: process_creation  # adjust per primary Sysmon event type
    product: windows
detection:
    selection:
    EventID: 3  # Sysmon Network Connection
    Initiated: &#x27;true&#x27;  # Outbound connection
    DestinationPort|contains|any:
      - &#x27;445&#x27;
      - &#x27;3389&#x27;
      - &#x27;5985&#x27;
      - &#x27;5986&#x27;
    Image|not|contains:
      - &#x27;\\Windows\\System32\\svchost.exe&#x27;
    condition: selection
level: critical
tags:
    - credential_access
    - exfiltration
    - t1003
    - t1041
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Hunt for <code>Sysmon 3 / Sysmon 10</code> events where Image is NOT in the approved software baseline</li>
  <li>Alert on Sysmon 3 / Sysmon 10 from accounts in privileged groups outside approved maintenance windows</li>
  <li>Correlate Sysmon 3 events with subsequent Windows Security 4624/4625 events to link process activity to authentication events</li>
  <li>Stack-rank <code>Sysmon 3 / Sysmon 10</code> events by Image path to identify rare/novel executables across the fleet</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Windows Defender, CrowdStrike, Carbon Black, and other AV/EDR engines open LSASS handles for monitoring</li>
  <li>Process monitoring tools (Process Explorer, Process Monitor) enumerate processes</li>
  <li>WER (Windows Error Reporting) generates LSASS dumps after application crashes</li>
  <li>Memory forensics tools (Volatility, Rekall) used legitimately by security teams</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enable LSASS Protection (PPL) via registry: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL = 1</code></li>
  <li>Disable WDigest to prevent plaintext credential caching: <code>UseLogonCredential = 0</code></li>
  <li>Enable Credential Guard on Windows 10/11 and Windows Server 2016+ to isolate LSASS</li>
  <li>Add lsass.exe as a protected process in Sysmon config to alert on any access event</li>
  <li>Block ProcessAccess to lsass.exe from non-system processes using EDR policy rules</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (from Sysmon Event 1 User field or Windows Security 4624 correlation) and disable it pending investigation.</li>
  <li>Preserve Sysmon event logs from the affected host(s) before any remediation — export the Microsoft-Windows-Sysmon/Operational channel.</li>
  <li>Correlate the Sysmon events with Windows Security logs using the LogonId field to link process activity to authenticated sessions.</li>
  <li>Reset passwords for all accounts confirmed or suspected to be compromised — prioritize privileged accounts.</li>
  <li>If KRBTGT hash was exposed (DCSync), perform two sequential KRBTGT password resets to invalidate existing golden tickets.</li>
  <li>Audit all Kerberos tickets issued since the credential dump — revoke suspicious TGTs by restarting the Kerberos service on DCs.</li>
  <li>Hunt for pass-the-hash or pass-the-ticket usage across the environment using correlated Sysmon Event 3 and Windows Security 4624 NTLM events.</li>
  <li>Review all accounts with DCSync rights (replication permissions) and remove any not belonging to designated sync accounts.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>