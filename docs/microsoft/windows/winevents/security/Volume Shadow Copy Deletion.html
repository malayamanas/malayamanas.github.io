<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Volume Shadow Copy Deletion</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Volume Shadow Copy Deletion</h1>
  <div class="page-meta">
    <span class="badge badge-critical">Critical</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Impact</span>
  </div>
  <div class="page-tags"><span class="tag-pill">impact</span> <span class="tag-pill">t1490</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> Volume Shadow Copy Deletion

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Volume Shadow Copy Deletion</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1490</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Impact</td></tr>
<tr><td><strong>Detection Level</strong></td><td>Critical</td></tr>
<tr><td><strong>Primary Event ID</strong></td><td>4688</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>impact, t1490</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary disrupts, destroys, or manipulates target systems and data by exploiting Inhibit System Recovery. Windows Security Event 4688 (A new process has been created) provides the primary detection signal when properly audited and monitored in a SIEM.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Impact  </li>
</ul><br>
  <strong>Technique</strong>       : Inhibit System Recovery (T1490)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker achieves local administrator or SYSTEM access on a targeted host or across the domain.</li>
  <li>Volume Shadow Copy deletion is executed using <code>vssadmin delete shadows /all /quiet</code>, <code>wmic shadowcopy delete</code>, or <code>bcdedit</code> to disable recovery.</li>
  <li>These commands appear as Event 4688 process creation events with the recognisable command lines targeting VSS.</li>
  <li>Simultaneous Event 7036 shows backup services (Windows Backup, Volume Shadow Copy Service, VSS) stopping.</li>
  <li>Without shadow copies, recovery from ransomware encryption or data destruction is severely hampered.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>vssadmin.exe (native)</li>
  <li>wmic.exe shadowcopy delete (native)</li>
  <li>PowerShell Get-WmiObject Win32_ShadowCopy | Remove-WmiObject</li>
  <li>Ransomware pre-encryption routines (LockBit, Conti, BlackCat)</li>
  <li>bcdedit /set {default} recoveryenabled No</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-id-4688-a-new-process-has-been-created">4. Key Windows Security Event Indicators (Event ID 4688 (A new process has been created))</h3>

<strong>Primary Detection Event:</strong> Security Event ID <strong>4688</strong> (A new process has been created)

<strong>Critical fields to monitor / correlate (Required attributes):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>SubjectUserSid</strong></td><td>Non-SYSTEM SID from an interactive user or service account not normally performing this action</td><td>Uniquely identifies the security principal; unexpected SIDs performing sensitive operations are high-priority IOCs</td></tr>
<tr><td><strong>SubjectUserName</strong></td><td>Unexpected user accounts, machine accounts in human context, or recently created/renamed accounts</td><td>Human-readable identity of the actor; enables cross-event correlation and user-behaviour analysis</td></tr>
<tr><td><strong>SubjectDomainName</strong></td><td>Workgroup name, external/untrusted domain, or NT AUTHORITY when privileged account is expected</td><td>Confirms account origin; cross-domain or workgroup operations in AD environments indicate lateral movement</td></tr>
<tr><td><strong>SubjectLogonId</strong></td><td>Correlate with Event 4624 to reveal logon type (3=network, 10=remote interactive), source IP, and workstation</td><td>Links this event to a specific authenticated session; essential for timeline and pivot-path reconstruction</td></tr>
<tr><td><strong>ProcessName</strong></td><td>System processes (lsass.exe, svchost.exe, winlogon.exe) performing unusual operations; user-space tools accessing protected resources</td><td>Identifies the executable performing the action; unexpected process names are a primary IOC</td></tr>
<tr><td><strong>CommandLine</strong></td><td>Base64-encoded commands (-EncodedCommand), LOLBin invocations (certutil -decode, mshta http://), C2 URIs, or obfuscated strings</td><td>Full command line reveals the attacker&#x27;s intent; encoded or obfuscated arguments are critical IOCs</td></tr>
<tr><td><strong>ParentProcessName</strong></td><td>Unusual parent-child relationships: Office apps spawning PowerShell, browsers launching cmd.exe, IIS (w3wp) spawning shells</td><td>Abnormal parent processes indicate exploitation, macro execution, or code injection as the initial vector</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (Critical Confidence)</strong>
<ul>
  <li>Alert on Event ID 4688 matching the highest-fidelity field combination shown above</li>
  <li>Apply thresholds appropriate to the environment: a single event may be sufficient for critical-level detections; volume thresholds apply for medium/low</li>
  <li>Correlate with Event 4624 (successful logon) using SubjectLogonId to establish the session context and identify the source IP and workstation</li>
</ul>

<strong>Highest-Fidelity Correlation (SIEM Query Logic):</strong>
<pre><code>EventID = 4688
AND SubjectUserName NOT IN &lt;approved_admin_accounts&gt;
AND CommandLine CONTAINS (&quot;-EncodedCommand&quot; OR &quot;mshta&quot; OR &quot;rundll32&quot; OR &quot;\\AppData\\&quot;)
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Correlate 4688 events where SubjectLogonId links to a Type 3 (network) or Type 10 (remote interactive) logon from an external IP address</li>
  <li>Alert on 4688 events from accounts in privileged groups (Domain Admins, Enterprise Admins) outside approved maintenance windows</li>
  <li>Hunt for 4688 events followed within 60 seconds by lateral movement indicators (5140, 4624 to other hosts) from the same SubjectLogonId</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate disk encryption tools (BitLocker, VeraCrypt, enterprise DLP encryption) generate similar file access patterns</li>
  <li>Large-scale data migration or backup operations may create bursts of file creation/modification events</li>
  <li>Anti-virus scan engines performing deep reads of files create access events without modification</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Implement immutable offline or air-gapped backups following the 3-2-1-1-0 backup rule</li>
  <li>Deploy application allowlisting to prevent unknown executables from running on endpoints and servers</li>
  <li>Enable Controlled Folder Access (Windows Defender) on all endpoints to block unauthorized file modification</li>
  <li>Segment networks to prevent ransomware from reaching backup infrastructure and file servers simultaneously</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (SubjectUserName/SubjectLogonId) and disable it pending investigation.</li>
  <li>Preserve all relevant Windows Security Event logs from the affected host(s) before any remediation.</li>
  <li>Correlate the triggering event with Event 4624 logon records to identify the source IP, workstation, and session that performed the action.</li>
  <li>Immediately disconnect all affected hosts from network shares and backup systems to prevent ransomware spread.</li>
  <li>Identify the ransomware strain and check for available decryptors (nomoreransom.org, vendor resources).</li>
  <li>Restore from the most recent clean backup after confirming the restore environment is isolated and clean.</li>
  <li>Engage legal, compliance, and communications teams as ransomware incidents typically trigger regulatory notification requirements.</li>
  <li>Conduct post-incident root cause analysis to identify and close the initial access vector before restoration.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>