<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EDRSilencer — WFP Custom Outbound Filter Blocking EDR</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">EDRSilencer — WFP Custom Outbound Filter Blocking EDR</h1>
  <div class="page-meta">
    <span class="badge badge-high">High</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Defense Evasion</span>
  </div>
  <div class="page-tags"><span class="tag-pill">defense_evasion</span> <span class="tag-pill">t1562</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> EDRSilencer — WFP Custom Outbound Filter Blocking EDR

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>EDRSilencer — WFP Custom Outbound Filter Blocking EDR</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1562</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Defense Evasion</td></tr>
<tr><td><strong>Detection Level</strong></td><td>High</td></tr>
<tr><td><strong>Primary Event ID</strong></td><td>5441</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>defense_evasion, t1562</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary bypasses, disables, or subverts security monitoring and controls by exploiting T1562. Windows Security Event 5441 (A filter was added to the Base Filtering Engine) provides the primary detection signal when properly audited and monitored in a SIEM.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Defense Evasion  </li>
</ul><br>
  <strong>Technique</strong>       : T1562 (T1562)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker achieves initial access to the target environment through social engineering, exploitation, or use of stolen credentials.</li>
  <li>Using the foothold, the attacker performs defense evasion activity related to EDRSilencer — WFP Custom Outbound Filter Blocking EDR, targeting the relevant Windows subsystem or service.</li>
  <li>The attack leverages MITRE ATT&amp;CK technique T1562 to achieve the objective, using tools and techniques common to this attack category.</li>
  <li>Windows Security Event(s) 5441, 5447 are generated, capturing critical details of the activity including the actor identity, target object, and operation performed.</li>
  <li>Post-attack, the attacker may perform additional lateral movement, persistence, or data collection based on the access gained.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>CobaltStrike (commercial C2 framework)</li>
  <li>Metasploit Framework (open-source exploitation)</li>
  <li>Impacket (Python network protocol library)</li>
  <li>CrackMapExec (post-exploitation framework)</li>
  <li>PowerSploit / PowerView (PowerShell attack modules)</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-id-5441-a-filter-was-added-to-the-base-filtering-engine-and-event-id-5447-a-windows-filtering-platform-filter-was-changed">4. Key Windows Security Event Indicators (Event ID 5441 (A filter was added to the Base Filtering Engine) and Event ID 5447 (A Windows Filtering Platform filter was changed))</h3>

<strong>Primary Detection Event:</strong> Security Event ID <strong>5441</strong> (A filter was added to the Base Filtering Engine)

<strong>Critical fields to monitor / correlate (Required attributes):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>SubjectSecurityID</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the SubjectSecurityID involved in this event</td></tr>
<tr><td><strong>SubjectAccountName</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the SubjectAccountName involved in this event</td></tr>
<tr><td><strong>SubjectAccountDomain</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the SubjectAccountDomain involved in this event</td></tr>
<tr><td><strong>SubjectLogonId</strong></td><td>Correlate with Event 4624 to reveal logon type (3=network, 10=remote interactive), source IP, and workstation</td><td>Links this event to a specific authenticated session; essential for timeline and pivot-path reconstruction</td></tr>
<tr><td><strong>ProcessID</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the ProcessID involved in this event</td></tr>
<tr><td><strong>ProcessName</strong></td><td>System processes (lsass.exe, svchost.exe, winlogon.exe) performing unusual operations; user-space tools accessing protected resources</td><td>Identifies the executable performing the action; unexpected process names are a primary IOC</td></tr>
<tr><td><strong>ChangeType</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the ChangeType involved in this event</td></tr>
<tr><td><strong>FilterName</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the FilterName involved in this event</td></tr>
<tr><td><strong>FilterType</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the FilterType involved in this event</td></tr>
<tr><td><strong>FilterID</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the FilterID involved in this event</td></tr>
<tr><td><strong>LayerName</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the LayerName involved in this event</td></tr>
<tr><td><strong>LayerKey</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the LayerKey involved in this event</td></tr>
<tr><td><strong>LayerID</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the LayerID involved in this event</td></tr>
<tr><td><strong>FilterWeight</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the FilterWeight involved in this event</td></tr>
<tr><td><strong>Action</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the Action involved in this event</td></tr>
<tr><td><strong>Conditions</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the Conditions involved in this event</td></tr>
<tr><td><strong>ProviderName</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the ProviderName involved in this event</td></tr>
<tr><td><strong>SubLayerName</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the SubLayerName involved in this event</td></tr>
<tr><td><strong>Keywords</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the Keywords involved in this event</td></tr>
<tr><td><strong>Level</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the Level involved in this event</td></tr>
<tr><td><strong>TaskCategory</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the TaskCategory involved in this event</td></tr>
<tr><td><strong>Channel</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the Channel involved in this event</td></tr>
<tr><td><strong>TimeCreated</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the TimeCreated involved in this event</td></tr>
<tr><td><strong>Computer</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the Computer involved in this event</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (High Confidence)</strong>
<ul>
  <li>Alert on Event ID 5441 matching the highest-fidelity field combination shown above</li>
  <li>Apply thresholds appropriate to the environment: a single event may be sufficient for critical-level detections; volume thresholds apply for medium/low</li>
  <li>Correlate with Event 4624 (successful logon) using SubjectLogonId to establish the session context and identify the source IP and workstation</li>
</ul>

<strong>Highest-Fidelity Correlation (SIEM Query Logic):</strong>
<pre><code>EventID = 5441
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Correlate 5441 events where SubjectLogonId links to a Type 3 (network) or Type 10 (remote interactive) logon from an external IP address</li>
  <li>Alert on 5441 events from accounts in privileged groups (Domain Admins, Enterprise Admins) outside approved maintenance windows</li>
  <li>Hunt for 5441 events followed within 60 seconds by lateral movement indicators (5140, 4624 to other hosts) from the same SubjectLogonId</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate administrative activity during change management windows may generate similar events</li>
  <li>Automated enterprise management platforms (SCCM, Ansible, Puppet) perform similar operations as part of configuration management</li>
  <li>Security scanning and vulnerability assessment tools may trigger events matching this pattern</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Apply the Principle of Least Privilege: restrict the ability to perform this action to explicitly approved accounts</li>
  <li>Enable advanced auditing via Group Policy (Advanced Audit Policy Configuration) to ensure all relevant events are captured</li>
  <li>Deploy a SIEM with behavioral analytics to baseline normal activity and alert on deviations</li>
  <li>Implement privileged access management (PAM) to control and audit use of privileged credentials</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (SubjectUserName/SubjectLogonId) and disable it pending investigation.</li>
  <li>Preserve all relevant Windows Security Event logs from the affected host(s) before any remediation.</li>
  <li>Correlate the triggering event with Event 4624 logon records to identify the source IP, workstation, and session that performed the action.</li>
  <li>Review all events from the same SubjectLogonId session to identify what other actions the attacker performed.</li>
  <li>Check for additional persistence mechanisms or privilege escalation attempts in the same time window.</li>
  <li>Conduct a threat hunt across similar hosts in the same network segment for the same indicators.</li>
  <li>Engage the incident response team to scope the full extent of the compromise before returning systems to production.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>