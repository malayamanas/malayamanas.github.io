<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Credential Stuffing — Valid Creds After Failures</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Credential Stuffing — Valid Creds After Failures</h1>
  <div class="page-meta">
    <span class="badge badge-medium">Medium</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Credential Access</span>
  </div>
  <div class="page-tags"><span class="tag-pill">credential_access</span> <span class="tag-pill">t1110.004</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0  
<strong>Date:</strong> February 2026  
<strong>Usecase ID / Name:</strong> Credential Stuffing — Valid Creds After Failures

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Credential Stuffing — Valid Creds After Failures</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1110.004</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Credential Access</td></tr>
<tr><td><strong>Detection Level</strong></td><td>Medium</td></tr>
<tr><td><strong>Primary Event IDs</strong></td><td>4625, 4624</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>credential_access, t1110.004</td></tr>
</tbody></table>

<strong>Short Description</strong>  
Credential stuffing is an automated attack in which attackers use username:password pairs leaked from previous breaches (often millions of records from sites unrelated to the target organization) and attempt to authenticate them against the victim environment. The pattern typically shows many failed logons (4625) across different accounts from the same source, followed by one or more successful logons (4624) using the same credentials and source IP.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Credential Access  </li>
</ul><br>
  <strong>Technique</strong>       : Brute Force: Credential Stuffing (T1110.004)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<p><ol>
  <li>Attacker obtains large credential dumps (from dark-web markets, breach compilation datasets, or previous compromises).</li>
  <li>Attacker filters / normalizes the list (usernames matching corporate email format, domain users).</li>
  <li>Attacker runs automated authentication attempts using the credential pairs against:</li>
</ol><br>
<ul>
  <li>OWA / Outlook Web Access</li>
  <li>ADFS / SAML endpoints</li>
  <li>VPN portals</li>
  <li>RDP (less common due to lockouts)</li>
  <li>Legacy NTLM endpoints (SMB, WinRM)</li>
</ul><br>
<ol>
  <li>Tool rotates through credentials slowly to avoid lockouts and detection.</li>
  <li>When a match is found → attacker gains valid session → often changes password, adds MFA bypass, or uses for lateral movement.</li>
</ol></p>

<strong>Most common tools &amp; vectors observed in 2024–2026:</strong>
<ul>
  <li>Sentry MBA / OpenBullet / BlackBullet / SNIPR / custom Python / Go bots</li>
  <li>CrackMapExec / Hydra with credential lists</li>
  <li>MSOnline / AzureAD PowerShell modules for cloud stuffing</li>
  <li>Selenium / headless browser automation for web portals</li>
  <li>External attacks against internet-facing ADFS, OWA, Citrix, VPN</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-ids-4625-4624">4. Key Windows Security Event Indicators (Event IDs 4625 + 4624)</h3>

<strong>Primary Detection Events:</strong>
<ul>
  <li><strong>4625</strong> — An account failed to log on (preceding failures)</li>
  <li><strong>4624</strong> — An account was successfully logged on (successful stuffing hit)</li>
</ul>

<strong>Critical fields to monitor / correlate (Required attributes from your CSV):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetUserName</strong></td><td>Many different accounts failing (4625) → one or few succeeding (4624) from same source</td><td>Breadth of failures + narrow success = stuffing pattern</td></tr>
<tr><td><strong>Status / SubStatus</strong> (4625)</td><td>0xC000006D + 0xC000006A (bad password) on many accounts</td><td>Consistent failure reason before success</td></tr>
<tr><td><strong>IpAddress</strong></td><td>Same / small cluster of IPs across both 4625 and 4624 events</td><td>Single bot / proxy / C2 node</td></tr>
<tr><td><strong>LogonType</strong></td><td>3 (Network), 10 (RDP), 8 (NetworkCleartext), 2 (Interactive – rare)</td><td>Common external stuffing vectors</td></tr>
<tr><td><strong>AuthenticationPackageName</strong> (4624 success)</td><td>NTLM or Negotiate (often NTLM fallback)</td><td>Many stuffing attacks still rely on NTLM</td></tr>
<tr><td><strong>WorkstationName</strong></td><td>Suspicious, random, missing, or matches known tooling</td><td>Attacker-controlled origin</td></tr>
</tbody></table>

<strong>Highest-fidelity combination (classic credential stuffing signature):</strong>
<pre><code>Many 4625 events (≥ 50–200 unique TargetUserName) from same IpAddress
Followed shortly by 4624 success(es) from same IpAddress
AuthenticationPackageName = NTLM (or Negotiate with NTLM fallback)
LogonType = 3 or 10
IpAddress = external / not in corporate VPN range
</code></pre>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (High Confidence)</strong>
<ul>
  <li>Cluster of 4625 failures (many unique accounts, same bad password status) from single IpAddress</li>
  <li>Followed by 4624 success from same IpAddress within 1–60 minutes</li>
  <li>IpAddress external or not matching known corporate ranges</li>
  <li>Exclude known noisy scanners / pen-test IPs via allow-list</li>
</ul>

<strong>Behavioral / Correlation-based Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>High unique TargetUserName count in 4625 events per IpAddress → low failures per account → then 4624 success</li>
  <li>4625 spray/stuffing pattern + 4624 success + unusual LogonGuid / WorkstationName</li>
  <li>External IP → high volume 4625 → 4624 success → look for privilege escalation (4672) or lateral movement (5140/5145)</li>
  <li>Correlate with enumeration: 4661/4662 LDAP user reads, 4798/4799 group membership queries</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate users reusing passwords across personal &amp; work accounts (rare pattern)</li>
  <li>Application/service misconfigurations causing repeated failures then correction</li>
  <li>Coordinated password reset campaigns (should be planned &amp; auditable)</li>
  <li>Red-team / pen-test activity (should be coordinated)</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enforce <strong>MFA</strong> on all external authentication surfaces (OWA, ADFS, VPN, Azure AD)</li>
  <li>Implement <strong>Azure AD smart lockout</strong> or on-prem equivalent that detects stuffing patterns</li>
  <li>Use <strong>banned password lists</strong> + complexity + history enforcement</li>
  <li><strong>Disable NTLM</strong> externally where possible — force Kerberos + channel binding</li>
  <li>Monitor &amp; alert on high unique failure counts followed by success from same source</li>
  <li>Use <strong>Conditional Access policies</strong> (location, device compliance, sign-in risk)</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li><strong>Block source IP(s)</strong> at firewall / WAF / Conditional Access level</li>
  <li><strong>Force password reset + MFA re-registration</strong> for any successfully stuffed accounts</li>
  <li><strong>Invalidate existing sessions</strong> (revoke refresh tokens, force sign-out)</li>
  <li>Hunt for lateral movement / privilege escalation from successful logons (5140/5145 shares, 7045 services, 4672 special privileges)</li>
  <li>Review 4625 → 4624 sequences, 4771 (Kerberos pre-auth failures), and 4740 (lockouts) from the source IP</li>
  <li>Audit exposed endpoints (OWA, ADFS, VPN) — consider geo-blocking or risk-based policies</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>