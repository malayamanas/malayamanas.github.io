<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APT Kill Chain — Password Spray to Golden Ticket</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">APT Kill Chain — Password Spray to Golden Ticket</h1>
  <div class="page-meta">
    <span class="badge badge-critical">Critical</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Credential Access | Lateral Movement</span>
  </div>
  <div class="page-tags"><span class="tag-pill">credential_access</span> <span class="tag-pill">lateral_movement</span> <span class="tag-pill">t1110.003</span> <span class="tag-pill">t1558.001</span> <span class="tag-pill">t1003.006</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> APT Kill Chain — Password Spray to Golden Ticket

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>APT Kill Chain — Password Spray to Golden Ticket</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1110.003</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Credential Access, Lateral Movement</td></tr>
<tr><td><strong>Detection Level</strong></td><td>Critical</td></tr>
<tr><td><strong>Primary Event ID</strong></td><td>4625</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>credential_access, lateral_movement, t1110.003, t1558.001, t1003.006</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary targets credentials or authentication material to enable further compromise by exploiting Brute Force: Password Spraying. Windows Security Event 4625 (An account failed to log on) provides the primary detection signal when properly audited and monitored in a SIEM.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Credential Access  </li>
</ul><br>
  <strong>Technique</strong>       : Brute Force: Password Spraying (T1110.003)<br>
<ul>
  <li><strong>Tactic</strong>          : Lateral Movement  </li>
</ul><br>
  <strong>Technique</strong>       : Steal or Forge Kerberos Tickets: Golden Ticket (T1558.001)<br>
<ul>
  <li><strong>Tactic</strong>          : Lateral Movement  </li>
</ul><br>
  <strong>Technique</strong>       : OS Credential Dumping: DCSync (T1003.006)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker has previously obtained the KRBTGT account&#x27;s NT hash (golden ticket) or a service account hash (silver ticket) via DCSync or credential dumping.</li>
  <li>Attacker uses Mimikatz (<code>kerberos::golden</code> or <code>kerberos::silver</code>) or Rubeus to forge a Kerberos ticket with arbitrary PAC data.</li>
  <li>The forged ticket is injected into the current logon session (<code>kerberos::ptt</code>) without contacting the KDC, bypassing normal Kerberos authentication.</li>
  <li>The attacker accesses domain resources using the forged ticket; Event 4769 (service ticket request) may appear with unusual encryption types or missing preceding TGT requests.</li>
  <li>Golden tickets can have lifetimes of up to 10 years and remain valid until KRBTGT password is reset twice.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>Mimikatz kerberos::golden / kerberos::silver</li>
  <li>Rubeus (golden / silver ticket modules)</li>
  <li>Impacket ticketer.py</li>
  <li>CobaltStrike Golden Ticket</li>
  <li>PyKEK</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-id-4625-an-account-failed-to-log-on">4. Key Windows Security Event Indicators (Event ID 4625 (An account failed to log on))</h3>

<strong>Primary Detection Event:</strong> Security Event ID <strong>4625</strong> (An account failed to log on)

<strong>Critical fields to monitor / correlate (Required attributes):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>SubjectUserSid</strong></td><td>Non-SYSTEM SID from an interactive user or service account not normally performing this action</td><td>Uniquely identifies the security principal; unexpected SIDs performing sensitive operations are high-priority IOCs</td></tr>
<tr><td><strong>SubjectUserName</strong></td><td>Unexpected user accounts, machine accounts in human context, or recently created/renamed accounts</td><td>Human-readable identity of the actor; enables cross-event correlation and user-behaviour analysis</td></tr>
<tr><td><strong>SubjectDomainName</strong></td><td>Workgroup name, external/untrusted domain, or NT AUTHORITY when privileged account is expected</td><td>Confirms account origin; cross-domain or workgroup operations in AD environments indicate lateral movement</td></tr>
<tr><td><strong>SubjectLogonId</strong></td><td>Correlate with Event 4624 to reveal logon type (3=network, 10=remote interactive), source IP, and workstation</td><td>Links this event to a specific authenticated session; essential for timeline and pivot-path reconstruction</td></tr>
<tr><td><strong>TargetUserName</strong></td><td>Privileged accounts (Administrator, KRBTGT, Domain Admin names, service accounts) are high-value targets</td><td>Identifies which account is under attack or being acted upon; privilege level determines impact</td></tr>
<tr><td><strong>Status</strong></td><td>0xC000006A (wrong password), 0xC0000064 (user doesn&#x27;t exist), 0xC000006D (auth failure), 0xC0000234 (account locked); 0x0 after prior failures = compromise</td><td>Authentication status/error code; sequential failure codes followed by 0x0 (success) reveal brute-force progression</td></tr>
<tr><td><strong>IpAddress</strong></td><td>Non-RFC1918 addresses, Tor exit nodes, cloud infrastructure IPs, or addresses not in the corporate IP inventory</td><td>Reveals the source of the connection; external or untrusted source IPs immediately elevate severity</td></tr>
<tr><td><strong>ServiceName</strong></td><td>Random or disguised service names (single characters, GUID-style, mimicking system services); newly installed services</td><td>Service name; unusual naming patterns or newly created services are common persistence/execution mechanisms</td></tr>
<tr><td><strong>TicketEncryptionType</strong></td><td>0x17 (RC4-HMAC) in AES-256-only environments indicates Kerberoasting, AS-REP roasting, or golden ticket attack with legacy encryption</td><td>Kerberos ticket encryption algorithm; RC4 in modern environments is a strong Kerberos attack indicator</td></tr>
<tr><td><strong>PreAuthType</strong></td><td>Unexpected or anomalous values in this field context</td><td>Provides essential context for understanding the PreAuthType involved in this event</td></tr>
<tr><td><strong>AccessList</strong></td><td>Replication rights GUIDs (DCSync), write/delete permissions on sensitive objects, or broad access masks on sensitive files</td><td>Specifies exact permissions granted; specific right combinations like DCSync GUIDs are definitive IOCs</td></tr>
<tr><td><strong>ObjectDN</strong></td><td>Domain root DN, Schema partition, sensitive user/computer DNs being modified; OU structure manipulation</td><td>Distinguished Name of the AD object; modifications to sensitive AD objects indicate domain-level compromise</td></tr>
<tr><td><strong>ObjectGUID</strong></td><td>GUID correlating to known sensitive AD objects (Domain root, schema objects, privileged groups)</td><td>Globally unique identifier; use to cross-reference with AD schema and identify the exact object being targeted</td></tr>
<tr><td><strong>ObjectClass</strong></td><td>groupPolicyContainer, trustedDomain, msDS-GroupManagedServiceAccount, user, computer objects being created or modified</td><td>AD object class; modifications to privileged classes indicate persistence, trust manipulation, or account creation</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (Critical Confidence)</strong>
<ul>
  <li>Alert on Event ID 4625 matching the highest-fidelity field combination shown above</li>
  <li>Apply thresholds appropriate to the environment: a single event may be sufficient for critical-level detections; volume thresholds apply for medium/low</li>
  <li>Correlate with Event 4624 (successful logon) using SubjectLogonId to establish the session context and identify the source IP and workstation</li>
</ul>

<strong>Highest-Fidelity Correlation (SIEM Query Logic):</strong>
<pre><code>EventID = 4625
AND SubjectUserName NOT IN &lt;approved_admin_accounts&gt;
AND IpAddress NOT IN &lt;trusted_ip_ranges&gt;
AND TicketEncryptionType = 0x17 (RC4)
AND (Status != 0x0 (failures) followed by Status = 0x0 (success))
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Correlate 4625 events where SubjectLogonId links to a Type 3 (network) or Type 10 (remote interactive) logon from an external IP address</li>
  <li>Alert on 4625 events from accounts in privileged groups (Domain Admins, Enterprise Admins) outside approved maintenance windows</li>
  <li>Hunt for 4625 events followed within 60 seconds by lateral movement indicators (5140, 4624 to other hosts) from the same SubjectLogonId</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate after-hours work by on-call staff, developers, or global teams in different time zones</li>
  <li>Service accounts performing scheduled maintenance tasks outside business hours</li>
  <li>Automated monitoring and backup systems generating logon events at any hour</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Implement privileged access workstations (PAW) to restrict administrative logons to dedicated secure hosts</li>
  <li>Enforce MFA for all remote and VPN logons to prevent credential-only attacks</li>
  <li>Configure Conditional Access policies to block high-risk logons based on impossible travel or unfamiliar devices</li>
  <li>Deploy LAPS to prevent lateral movement using shared local administrator credentials</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (SubjectUserName/SubjectLogonId) and disable it pending investigation.</li>
  <li>Preserve all relevant Windows Security Event logs from the affected host(s) before any remediation.</li>
  <li>Correlate the triggering event with Event 4624 logon records to identify the source IP, workstation, and session that performed the action.</li>
  <li>Reset passwords for all accounts confirmed or suspected to be compromised; prioritise privileged accounts.</li>
  <li>If KRBTGT hash was exposed (DCSync), perform two sequential KRBTGT password resets to invalidate existing golden tickets.</li>
  <li>Audit and revoke any Kerberos service tickets (TGTs/TGS) that may have been captured; force re-authentication.</li>
  <li>Review and revoke any certificates issued around the time of the attack (check AD CS audit logs).</li>
  <li>Hunt for pass-the-hash or pass-the-ticket usage across the environment using Event 4624 NTLM logon correlation.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>