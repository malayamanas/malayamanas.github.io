<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Group Policy — Scheduled Task via GPO Abuse</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Group Policy — Scheduled Task via GPO Abuse</h1>
  <div class="page-meta">
    <span class="badge badge-high">High</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Execution | Persistence</span>
  </div>
  <div class="page-tags"><span class="tag-pill">persistence</span> <span class="tag-pill">execution</span> <span class="tag-pill">t1484.001</span> <span class="tag-pill">t1053.005</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0
<strong>Date:</strong> February 2026
<strong>Usecase ID / Name:</strong> Group Policy — Scheduled Task via GPO Abuse

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Group Policy — Scheduled Task via GPO Abuse</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1484.001</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Execution, Persistence</td></tr>
<tr><td><strong>Detection Level</strong></td><td>High</td></tr>
<tr><td><strong>Primary Event ID</strong></td><td>4698</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>persistence, execution, t1484.001, t1053.005</td></tr>
</tbody></table>

<strong>Short Description</strong>
An adversary runs attacker-controlled code on the target system by exploiting Domain Policy Modification: Group Policy Modification. Windows Security Event 4698 (A scheduled task was created) provides the primary detection signal when properly audited and monitored in a SIEM.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Execution  </li>
</ul><br>
  <strong>Technique</strong>       : Domain Policy Modification: Group Policy Modification (T1484.001)<br>
<ul>
  <li><strong>Tactic</strong>          : Persistence  </li>
</ul><br>
  <strong>Technique</strong>       : Scheduled Task/Job: Scheduled Task (T1053.005)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<ol>
  <li>Attacker gains initial foothold with user-level or administrative privileges on a target system.</li>
  <li>Attacker creates or modifies a scheduled task using <code>schtasks.exe</code>, PowerShell <code>Register-ScheduledTask</code>, or the COM-based Task Scheduler API.</li>
  <li>The task action is configured to execute a malicious payload (PowerShell cradle, encoded command, or dropped binary) on a trigger (logon, system start, or scheduled time).</li>
  <li>Windows generates Event 4698 (task created) or 4702 (task modified), recording the full XML task definition in <code>TaskContent</code>.</li>
  <li>The task fires and executes the payload, often under SYSTEM or a privileged account context, providing persistence across reboots.</li>
</ol>

<strong>Most common tools observed in 2024–2026:</strong>
<ul>
  <li>Native <code>schtasks.exe</code> / <code>at.exe</code></li>
  <li>PowerShell <code>Register-ScheduledTask</code></li>
  <li>CobaltStrike scheduled task persistence</li>
  <li>Impacket <code>atexec.py</code></li>
  <li>SharPersist</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-id-4698-a-scheduled-task-was-created-and-event-id-5136-a-directory-service-object-was-modified">4. Key Windows Security Event Indicators (Event ID 4698 (A scheduled task was created) and Event ID 5136 (A directory service object was modified))</h3>

<strong>Primary Detection Event:</strong> Security Event ID <strong>4698</strong> (A scheduled task was created)

<strong>Critical fields to monitor / correlate (Required attributes):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>SubjectUserSid</strong></td><td>Non-SYSTEM SID from an interactive user or service account not normally performing this action</td><td>Uniquely identifies the security principal; unexpected SIDs performing sensitive operations are high-priority IOCs</td></tr>
<tr><td><strong>SubjectUserName</strong></td><td>Unexpected user accounts, machine accounts in human context, or recently created/renamed accounts</td><td>Human-readable identity of the actor; enables cross-event correlation and user-behaviour analysis</td></tr>
<tr><td><strong>SubjectDomainName</strong></td><td>Workgroup name, external/untrusted domain, or NT AUTHORITY when privileged account is expected</td><td>Confirms account origin; cross-domain or workgroup operations in AD environments indicate lateral movement</td></tr>
<tr><td><strong>SubjectLogonId</strong></td><td>Correlate with Event 4624 to reveal logon type (3=network, 10=remote interactive), source IP, and workstation</td><td>Links this event to a specific authenticated session; essential for timeline and pivot-path reconstruction</td></tr>
<tr><td><strong>TaskName</strong></td><td>Task names mimicking legitimate Windows tasks (\Microsoft\Windows\...); unusual paths in Task Scheduler</td><td>Scheduled task identifier; hiding in trusted task namespaces is a primary evasion technique</td></tr>
<tr><td><strong>TaskContent</strong></td><td>XML containing encoded PowerShell (-EncodedCommand), LOLBin execution, UNC paths, or %TEMP%/%AppData% binaries</td><td>Full XML definition of the task; the Exec/Action element reveals the malicious payload injected by the attacker</td></tr>
<tr><td><strong>ObjectDN</strong></td><td>Domain root DN, Schema partition, sensitive user/computer DNs being modified; OU structure manipulation</td><td>Distinguished Name of the AD object; modifications to sensitive AD objects indicate domain-level compromise</td></tr>
<tr><td><strong>ObjectGUID</strong></td><td>GUID correlating to known sensitive AD objects (Domain root, schema objects, privileged groups)</td><td>Globally unique identifier; use to cross-reference with AD schema and identify the exact object being targeted</td></tr>
<tr><td><strong>ObjectClass</strong></td><td>groupPolicyContainer, trustedDomain, msDS-GroupManagedServiceAccount, user, computer objects being created or modified</td><td>AD object class; modifications to privileged classes indicate persistence, trust manipulation, or account creation</td></tr>
<tr><td><strong>AttributeLDAPDisplayName</strong></td><td>member (group membership), unicodePwd (password), userAccountControl (account flags), msDS-KeyCredentialLink (Shadow Credentials), servicePrincipalName (Kerberoasting)</td><td>The LDAP attribute being changed; sensitive attributes are primary targets for persistence and privilege escalation</td></tr>
<tr><td><strong>AttributeSyntaxOID</strong></td><td>Object identifiers for complex or rarely-used attribute types may indicate schema manipulation or unusual AD operations</td><td>Defines the data type of the attribute being modified; complex OIDs help identify the nature of the change</td></tr>
<tr><td><strong>AttributeValue</strong></td><td>New group members in privileged groups; encoded or obfuscated password values; UAC flags enabling attack vectors (e.g., DONT_REQ_PREAUTH)</td><td>The actual value written to the AD attribute; new privileged group members or suspicious flag values are direct IOCs</td></tr>
<tr><td><strong>DSName</strong></td><td>Unexpected domain or application partition names; cross-forest partition modifications from non-DC accounts</td><td>Identifies the directory service partition; cross-partition operations from unexpected sources indicate privilege abuse</td></tr>
<tr><td><strong>DSType</strong></td><td>Active Directory Domain Services vs. Lightweight Directory Services; unexpected type changes may reveal attack surface expansion</td><td>Type of directory service involved; anomalies here help distinguish domain-level from application-level AD attacks</td></tr>
<tr><td><strong>OpCorrelationID</strong></td><td>Groups multiple directory service write operations; correlate with nearby 5136 events using the same ID</td><td>Correlates multiple AD operations in one atomic change; useful for reconstructing complex multi-step AD modifications</td></tr>
<tr><td><strong>AppCorrelationID</strong></td><td>Application-level correlation ID; Mimikatz and Impacket generate distinctive patterns visible here</td><td>Application-level tracking identifier; tool-specific patterns can fingerprint the attacker&#x27;s toolkit</td></tr>
</tbody></table>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (High Confidence)</strong>
<ul>
  <li>Alert on Event ID 4698 matching the highest-fidelity field combination shown above</li>
  <li>Apply thresholds appropriate to the environment: a single event may be sufficient for critical-level detections; volume thresholds apply for medium/low</li>
  <li>Correlate with Event 4624 (successful logon) using SubjectLogonId to establish the session context and identify the source IP and workstation</li>
</ul>

<strong>Highest-Fidelity Correlation (SIEM Query Logic):</strong>
<pre><code>EventID = 4698
AND SubjectUserName NOT IN &lt;approved_admin_accounts&gt;
AND (NewValue CONTAINS &quot;powershell&quot; OR TaskContent CONTAINS &quot;-EncodedCommand&quot;)
</code></pre>

<strong>Contextual / Behavioral Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Correlate 4698 events where SubjectLogonId links to a Type 3 (network) or Type 10 (remote interactive) logon from an external IP address</li>
  <li>Alert on 4698 events from accounts in privileged groups (Domain Admins, Enterprise Admins) outside approved maintenance windows</li>
  <li>Hunt for 4698 events followed within 60 seconds by lateral movement indicators (5140, 4624 to other hosts) from the same SubjectLogonId</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Software installers and update mechanisms (Windows Update, SCCM, PDQ Deploy) frequently create and modify scheduled tasks</li>
  <li>Group Policy application triggers task updates across domain-joined machines</li>
  <li>Enterprise monitoring agents (backup, AV, telemetry) register recurring tasks on installation</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enable Windows Scheduled Task auditing (Event 4698/4702) across all endpoints via Group Policy</li>
  <li>Restrict schtasks.exe and Register-ScheduledTask to administrators using AppLocker/WDAC</li>
  <li>Baseline all scheduled tasks and alert on any task whose action command line does not match the baseline</li>
  <li>Monitor the Task Scheduler operational event log for additional context alongside security events</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li>Isolate the affected host from the network immediately if active exploitation or lateral movement is confirmed.</li>
  <li>Identify the initiating account (SubjectUserName/SubjectLogonId) and disable it pending investigation.</li>
  <li>Preserve all relevant Windows Security Event logs from the affected host(s) before any remediation.</li>
  <li>Correlate the triggering event with Event 4624 logon records to identify the source IP, workstation, and session that performed the action.</li>
  <li>Identify and remove the persistence mechanism (registry key, scheduled task, service, or DLL) from all affected hosts.</li>
  <li>Search for the same persistence IOC (file hash, registry key value, task content) across all endpoints in the environment.</li>
  <li>Review the affected account&#x27;s full activity history for the past 30 days to understand the scope of the compromise.</li>
  <li>Rebuild the affected host from a known-good image if deep persistence (bootkit, firmware, or multiple mechanisms) is suspected.</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>