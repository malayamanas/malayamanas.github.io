<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Password Spraying — Failures Across Many Accounts</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">Password Spraying — Failures Across Many Accounts</h1>
  <div class="page-meta">
    <span class="badge badge-high">High</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Credential Access</span>
  </div>
  <div class="page-tags"><span class="tag-pill">credential_access</span> <span class="tag-pill">t1110.003</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0  
<strong>Date:</strong> February 2026  
<strong>Usecase ID / Name:</strong> Password Spraying — Failures Across Many Accounts

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>Password Spraying — Failures Across Many Accounts</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1110.003</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Credential Access</td></tr>
<tr><td><strong>Detection Level</strong></td><td>High</td></tr>
<tr><td><strong>Primary Event ID</strong></td><td>4625</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>credential_access, t1110.003</td></tr>
</tbody></table>

<strong>Short Description</strong>  
Password spraying is a credential access technique in which an attacker attempts a small number of very common or weak passwords (e.g., Password1, Welcome2025, Summer2026, Company123) across a large number of different accounts — deliberately staying below account lockout thresholds. The goal is to find at least one valid credential without triggering rapid lockouts on any single account.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Credential Access  </li>
</ul><br>
  <strong>Technique</strong>       : Brute Force: Password Spraying (T1110.003)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<p><ol>
  <li>Attacker enumerates valid usernames (via:</li>
</ol><br>
<ul>
  <li>LDAP anonymous bind</li>
  <li>Harvesting from public sources (LinkedIn, email format guessing)</li>
  <li>Previous breaches</li>
  <li>BloodHound / SharpHound collection</li>
  <li>On-network enumeration: 4798/4799 group membership, 4661/4662 LDAP reads)</li>
</ul><br>
<ol>
  <li>Attacker selects a small set of very common / seasonal / organization-specific weak passwords.</li>
  <li>Attacker rotates through the username list, trying one password per account in a slow, distributed manner.</li>
  <li>Attempts are made against:</li>
</ol><br>
<ul>
  <li>Domain logons (LDAP, SMB, WinRM, RDP)</li>
  <li>OWA / ADFS / Azure AD endpoints (externally)</li>
  <li>VPN portals</li>
</ul><br>
<ol>
  <li>Goal: achieve at least one successful authentication (4624) while avoiding lockouts (4740).</li>
</ol></p>

<strong>Most common tools &amp; vectors observed in 2024–2026:</strong>
<ul>
  <li>CrackMapExec (<code>--continue-on-success -u users.txt -p Spring2026!</code>)</li>
  <li>Spray365 / DomainPasswordSpray.ps1</li>
  <li>Hydra / Medusa with low threads &amp; delay</li>
  <li>Custom Python / PowerShell scripts</li>
  <li>External spraying against OWA, ADFS, Azure AD (MSOnline PowerShell, roadtools)</li>
  <li>Low-volume spraying via legitimate user agents (mimicking Outlook, browser)</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-id-4625">4. Key Windows Security Event Indicators (Event ID 4625)</h3>

<strong>Primary Detection Event:</strong> Security Event ID <strong>4625</strong> (An account failed to log on)

<strong>Critical fields to monitor / correlate (Required attributes from your CSV):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>TargetUserName</strong></td><td>Many different accounts in short time window (dozens to hundreds)</td><td>Core signature: breadth over depth</td></tr>
<tr><td><strong>Status / SubStatus</strong></td><td>0xC000006D + 0xC000006A (bad password)</td><td>Consistent failure reason across many accounts</td></tr>
<tr><td><strong>IpAddress</strong></td><td>Single / small number of IPs (often external, VPN exit node, or internal jump host)</td><td>Spray usually comes from one or few sources</td></tr>
<tr><td><strong>WorkstationName</strong></td><td>Suspicious, random, missing, or matches known tooling</td><td>Attacker-controlled origin</td></tr>
<tr><td><strong>LogonType</strong></td><td>3 (Network), 10 (RDP), 2 (Interactive – rare), 8 (NetworkCleartext)</td><td>Common vectors for spraying</td></tr>
</tbody></table>

<strong>Highest-fidelity combination (classic password spraying signature):</strong>
<pre><code>Event ID = 4625
Status/SubStatus = bad password combo (0xC000006D/0xC000006A)
Many unique TargetUserName values from same IpAddress / small set of IPs
→ threshold: &gt; 20–50 unique accounts failed from same source in &lt; 1–4 hours
→ no single account exceeds lockout threshold
</code></pre>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (High Confidence)</strong>
<ul>
  <li>Event ID = 4625</li>
  <li>Same IpAddress (or small cluster) fails authentication against ≥ 30–50 unique TargetUserName</li>
  <li>Status/SubStatus = bad password</li>
  <li>No account reaches lockout count (4740) during the window</li>
  <li>Exclude known noisy scanners / monitoring via allow-list</li>
</ul>

<strong>Behavioral / Correlation-based Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>Count of unique TargetUserName per IpAddress in 4625 events → high unique count + low failures per account = spraying</li>
  <li>4625 spray pattern + successful 4624 shortly after from same IpAddress = successful spray</li>
  <li>Correlate with enumeration: 4661/4662 LDAP user reads, 4798/4799 group membership queries</li>
  <li>External spraying: 4625 from public IPs targeting OWA/ADFS/RDP</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Legitimate users mistyping passwords across multiple accounts (very rare)</li>
  <li>Application/service account misconfigurations (usually repetitive same account)</li>
  <li>Vulnerability scanners / pen-test tools (should be coordinated)</li>
  <li>Backup / monitoring agents with stale credentials</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enforce <strong>strong password policy</strong> + banned password lists (Azure AD Password Protection or on-prem equivalent)</li>
  <li>Implement <strong>account lockout policy</strong> with reasonable thresholds (but understand spraying evades it)</li>
  <li>Require <strong>MFA</strong> on all external-facing authentication (OWA, VPN, ADFS, Azure AD)</li>
  <li><strong>Disable NTLM</strong> where possible — force Kerberos</li>
  <li>Monitor and alert on high unique failure counts from single sources</li>
  <li>Use <strong>smart lockout</strong> features (Azure AD) that detect spraying patterns</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li><strong>Block source IP(s)</strong> at firewall / WAF level</li>
  <li>Force password reset + MFA re-enrollment for any successfully sprayed accounts (look for 4624 after spray window)</li>
  <li>Hunt for successful logons from same IpAddress shortly after spray attempts</li>
  <li>Review 4625, 4624, 4771 (Kerberos pre-auth failures), and 4740 (lockouts) events from the source</li>
  <li>Check for follow-on activity: lateral movement (5140/5145 shares, 7045 services), privilege escalation (4672, 5136)</li>
  <li>Audit exposed authentication endpoints (RDP, OWA, ADFS) — consider Conditional Access policies</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>