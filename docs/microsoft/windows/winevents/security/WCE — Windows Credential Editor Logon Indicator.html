<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WCE — Windows Credential Editor Logon Indicator</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar">
  <a href="index.html" class="nav-back">&#8592; Back to Index</a>
  <span class="nav-title">Windows Security SOP</span>
</nav>
<div class="page-header">
  <h1 class="page-title">WCE — Windows Credential Editor Logon Indicator</h1>
  <div class="page-meta">
    <span class="badge badge-high">High</span>
    <span class="meta-item"><strong>Event IDs:</strong> </span>
    <span class="meta-item"><strong>Tactics:</strong> Credential Access</span>
  </div>
  <div class="page-tags"><span class="tag-pill">credential_access</span> <span class="tag-pill">t1003</span></div>
</div>
<main class="content">
<hr>

<strong>Microsoft Windows Security Event Detection – Attack Technique Profile</strong>

<strong>Document Version:</strong> 1.0  
<strong>Date:</strong> February 2026  
<strong>Usecase ID / Name:</strong> WCE — Windows Credential Editor Logon Indicator

<h3 id="1-technique-summary">1. Technique Summary</h3>

<table>
<thead>
<tr><th>Field</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td><strong>Usecase Name</strong></td><td>WCE — Windows Credential Editor Logon Indicator</td></tr>
<tr><td><strong>MITRE ATT&amp;CK Technique ID</strong></td><td>T1003</td></tr>
<tr><td><strong>MITRE Tactic(s)</strong></td><td>Credential Access</td></tr>
<tr><td><strong>Detection Level</strong></td><td>High</td></tr>
<tr><td><strong>Primary Event ID</strong></td><td>4624</td></tr>
<tr><td><strong>Log Source</strong></td><td>Windows Security Event Log</td></tr>
<tr><td><strong>Logsource Service Type</strong></td><td>security</td></tr>
<tr><td><strong>Tags</strong></td><td>credential_access, t1003</td></tr>
</tbody></table>

<strong>Short Description</strong>  
Windows Credential Editor (WCE) is a legacy but still occasionally observed tool used to dump credentials from LSASS memory (similar to Mimikatz sekurlsa modules). When WCE performs pass-the-hash or injects credentials, it often creates a new logon session with distinctive characteristics visible in Event ID 4624 — most notably unusual values in LogonProcessName, AuthenticationPackageName, or KeyLength fields that serve as reliable indicators of WCE usage.

<h3 id="2-mitre-attck-mapping">2. MITRE ATT&amp;CK Mapping</h3>

<p><ul>
  <li><strong>Tactic</strong>          : Credential Access  </li>
</ul><br>
  <strong>Technique</strong>       : OS Credential Dumping (T1003)  <br>
  <strong>Sub-technique</strong>   : (legacy tool fingerprint — LSASS memory access &amp; pass-the-hash)</p>

<h3 id="3-how-the-attack-typically-works-procedure">3. How the Attack Typically Works (Procedure)</h3>

<p><ol>
  <li>Attacker gains administrative or SYSTEM privileges on the target Windows system.</li>
  <li>Attacker executes WCE to:</li>
</ol><br>
<ul>
  <li>Dump credentials from LSASS (<code>wce.exe -w</code>)</li>
  <li>Perform pass-the-hash (<code>wce.exe -s &lt;hash&gt;</code>)</li>
  <li>List / clear credentials (<code>wce.exe -l</code>, <code>-c</code>)</li>
</ul><br>
<ol>
  <li>When WCE injects credentials or creates a new logon session (e.g., via pass-the-hash), it triggers a 4624 event with telltale signs:</li>
</ol><br>
<ul>
  <li>LogonProcessName = WceAux (or similar typo/variant used in older WCE builds)</li>
  <li>Unusual KeyLength = 0</li>
  <li>AuthenticationPackageName = NTLM</li>
  <li>ImpersonationLevel or session characteristics differing from normal logons</li>
</ul><br>
<ol>
  <li>Attacker uses dumped/injected credentials for lateral movement (pass-the-hash, pass-the-ticket).</li>
</ol></p>

<strong>Most common tools &amp; indicators observed in 2024–2026:</strong>
<ul>
  <li>WCE.exe (older versions still circulate in red-team kits &amp; malware)</li>
  <li>Variants / forks of WCE with renamed binaries</li>
  <li>Mimikatz &amp; Rubeus have largely replaced WCE, but WCE fingerprints remain useful for legacy/niche detections</li>
  <li>Often seen in older campaigns or attackers reusing archived tools</li>
</ul>

<h3 id="4-key-windows-security-event-indicators-event-id-4624">4. Key Windows Security Event Indicators (Event ID 4624)</h3>

<strong>Primary Detection Event:</strong> Security Event ID <strong>4624</strong> (An account was successfully logged on)

<strong>Critical fields to monitor / correlate (Required attributes from your CSV):</strong>

<table>
<thead>
<tr><th>Field</th><th>Typical malicious / suspicious value(s) / pattern</th><th>Why it matters</th></tr>
</thead>
<tbody>
<tr><td><strong>LogonProcessName</strong></td><td>WceAux (classic WCE fingerprint — often typo’d or exact match in many builds)</td><td>Strongest IOC — very few legitimate processes use this name</td></tr>
<tr><td><strong>AuthenticationPackageName</strong></td><td>NTLM</td><td>WCE pass-the-hash uses NTLM</td></tr>
<tr><td><strong>KeyLength</strong></td><td>0</td><td>No key material exchanged — classic pass-the-hash / injection indicator</td></tr>
<tr><td><strong>LogonType</strong></td><td>3 (Network) or 2 (Interactive) — depending on injection method</td><td>Common for WCE pass-the-hash or local session creation</td></tr>
<tr><td><strong>IpAddress / WorkstationName</strong></td><td>Attacker-controlled or local (127.0.0.1) when injecting locally</td><td>Source of the injected logon</td></tr>
<tr><td><strong>TargetUserName</strong></td><td>Privileged or high-value account being impersonated</td><td>Credentials being abused</td></tr>
</tbody></table>

<strong>Highest-fidelity combination (classic WCE indicator):</strong>
<pre><code>Event ID = 4624
LogonProcessName = WceAux (case-insensitive match)
AuthenticationPackageName = NTLM
KeyLength = 0
LogonType = 3 (or sometimes 2/7)
→ immediate high-confidence alert — extremely rare in legitimate activity
</code></pre>

<h3 id="5-detection-hunting-recommendations">5. Detection / Hunting Recommendations</h3>

<strong>Strong / Classic Signature Rule (High Confidence)</strong>
<ul>
  <li>Event ID = 4624</li>
  <li>LogonProcessName = &quot;WceAux&quot; (exact or case-insensitive match)</li>
  <li>KeyLength = 0</li>
  <li>AuthenticationPackageName = NTLM</li>
</ul>

<strong>Behavioral / Correlation-based Hunting Queries (SIEM / EDR)</strong>
<ul>
  <li>4624 with LogonProcessName containing &quot;Wce&quot; or &quot;WceAux&quot;</li>
  <li>WCE fingerprint + preceding LSASS access (4656/4663 on lsass.exe)</li>
  <li>4624 WCE indicator + subsequent lateral movement (5140/5145 shares, 7045 service creation)</li>
  <li>Process creation (4688) of wce.exe or renamed variants</li>
</ul>

<strong>False Positive Considerations</strong>
<ul>
  <li>Extremely rare — almost no legitimate software registers &quot;WceAux&quot; as a logon process</li>
  <li>Potential false positives only from deliberate red-team simulation or renamed malicious tools mimicking WCE</li>
</ul>

<strong>Recommended Hardening (Prevention &amp; Impact Reduction)</strong>
<ul>
  <li>Enable <strong>Credential Guard</strong> and <strong>LSA Protection (RunAsPPL)</strong> — prevents LSASS credential dumping</li>
  <li>Restrict <strong>SeDebugPrivilege</strong> — remove from Administrators group where possible</li>
  <li>Use <strong>AppLocker / WDAC</strong> to block wce.exe and common credential dumper names</li>
  <li>Monitor and alert on any LogonProcessName values not in a known-good baseline (e.g., Advapi, Kerberos, NtLmSsp, User32)</li>
  <li>Apply strict process execution policies on endpoints</li>
</ul>

<h3 id="6-recommended-response-actions">6. Recommended Response Actions</h3>

<ul>
  <li><strong>Isolate the host</strong> immediately (source of WCE logon indicator)</li>
  <li>Kill suspicious processes and search for wce.exe / renamed variants</li>
  <li>Reset passwords of any accounts appearing in the 4624 TargetUserName field</li>
  <li>Force sign-out / ticket invalidation for affected accounts</li>
  <li>Hunt for credential usage from the injected session (further 4624 Type 3 logons, 5140/5145 share access)</li>
  <li>Review 4624, 4656/4663 (LSASS access), and 4688 (process creation) events around the time of detection</li>
  <li>Check for follow-on activity: pass-the-hash lateral movement, service installation (7045), scheduled tasks (4698)</li>
</ul>

<hr>
</main>
<footer class="page-footer">
  <a href="index.html">&#8592; Back to Index</a>
</footer>
</body>
</html>